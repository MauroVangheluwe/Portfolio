---
import { Image } from "astro:assets";
const { project } = Astro.props;

// Check if cover image is a GIF
const coverImg = project.data.img;
const isGif =
  (typeof coverImg === "object" &&
    coverImg.src &&
    typeof coverImg.src === "string" &&
    coverImg.src.endsWith(".gif")) ||
  (typeof coverImg === "object" && coverImg.format === "gif");
---

{
  project ? (
    <a
      href={`${import.meta.env.BASE_URL}/projects/${project.id}`}
      class="project-card"
      data-project-id={project.id}
    >
      <div class="card-image-wrapper">
        <div class="card-tags">
          {project.data.creativeField.map((field: string) => (
            <span class="tag">{field}</span>
          ))}
        </div>
        {isGif ? (
          <img src={coverImg.src} alt={project.data.name} class="card-cover" />
        ) : (
          <Image
            src={project.data.img}
            alt={project.data.name}
            class="card-cover"
            widths={[260, 300, 450]}
            sizes="(min-width: 64rem) 450px, (min-width: 40rem) 300px, 260px"
            format="webp"
          />
        )}
      </div>
      <div class="card-title">{project.data.name}</div>
    </a>
  ) : (
    <p>No project found</p>
  )
}

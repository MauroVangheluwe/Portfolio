---
interface Props {
  href?: string;
  text: string;
  direction?: "left" | "right";
  position?: "fixed" | "inline";
  class?: string;
  useHistory?: boolean;
}

const {
  href = "",
  text,
  direction = "left",
  position = "inline",
  class: className = "",
  useHistory = false,
} = Astro.props;
const arrow = direction === "left" ? "←" : "→";
const BASE_URL = import.meta.env.BASE_URL || "/";
// Ensure proper path joining - remove leading slash from href if BASE_URL has trailing slash
const normalizedHref = href.startsWith("/") ? href.slice(1) : href;
const fullPath = BASE_URL.endsWith("/")
  ? `${BASE_URL}${normalizedHref}`
  : `${BASE_URL}/${normalizedHref}`;
---

<a
  href={useHistory ? "#" : fullPath}
  class={`nav-button ${position === "fixed" ? "nav-button-fixed" : ""} ${className}`}
  data-use-history={useHistory}
>
  {direction === "left" && <span class="arrow">{arrow}</span>}
  <span class="text">{text}</span>
  {direction === "right" && <span class="arrow">{arrow}</span>}
</a>

<style>
  .nav-button {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;

    padding: 0.4rem 1.2rem;
    border-radius: var(--border-radius-sm);
    box-shadow: var(--box-shadow);
    border: none;

    font-family: "Owners-XNarrow", sans-serif;
    font-size: 1.3rem;
    font-weight: 800;
    color: var(--color-blue-dark);
    background-color: var(--color-blue-light);
    text-decoration: none;
    text-transform: uppercase;

    cursor: pointer;
    transition: all 0.5s ease;
    z-index: 100;
  }

  .nav-button-fixed {
    position: fixed;
    bottom: 1.5rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
  }

  .nav-button .text {
    letter-spacing: -0.02em;
  }

  .nav-button:hover {
    gap: 1rem;
  }

  .nav-button .arrow {
    font-size: 1.8rem;
  }

  /* Responsive styles */
  @media (min-width: 48rem) {
    .nav-button {
      font-size: 1.5rem;
      padding: 0.5rem 1.5rem;
    }

    .nav-button .arrow {
      font-size: 2rem;
    }

    .nav-button-fixed {
      bottom: 2rem;
    }
  }

  @media (min-width: 64rem) {
    .nav-button {
      font-size: 1.8rem;
      padding: 0.6rem 1.8rem;
    }

    .nav-button .arrow {
      font-size: 2.2rem;
    }

    .nav-button-fixed {
      bottom: 2.5rem;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll(
      '.nav-button[data-use-history="true"]'
    );
    buttons.forEach((button) => {
      button.addEventListener("click", (e) => {
        e.preventDefault();
        window.history.back();
      });
    });
  });
</script>
